# Render Blueprint for Uniमित्र Django + React App

services:
  - type: web
    name: unimitr-backend
    env: python
    plan: free
    buildCommand: |
      pip install -r backend/requirements.txt
      cd frontend && npm install && npm run build
      cd .. && python backend/manage.py collectstatic --noinput
    startCommand: gunicorn unimitr.wsgi:application --chdir backend
    envVars:
      - key: DJANGO_SECRET_KEY
        sync: false
      - key: DJANGO_DEBUG
        value: "False"
      - key: DATABASE_URL
        sync: false
      - key: ALLOWED_HOSTS
        value: "render.com"
    staticPublishPath: backend/staticfiles_build/frontend
    autoDeploy: true

staticSites:
  - name: unimitr-frontend
    buildCommand: npm install && npm run build
    publishPath: build
    env: node
    plan: free
    autoDeploy: true
